{
  "cells": [
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "ab5ccc30",
        "language": "markdown"
      },
      "source": [
        "# Ejemplos Interactivos de Python en DevOps",
        "",
        "Este notebook muestra ejemplos ejecutables de Python para tareas comunes en DevOps, como parsing de configuraciones, ejecución de comandos y manipulación de datos."
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "06a20623",
        "language": "markdown"
      },
      "source": [
        "## Parsing de YAML para configuraciones Ansible",
        "",
        "En DevOps, a menudo necesitamos parsear archivos YAML para configuraciones. Aquí un ejemplo con Python:"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "06787579",
        "language": "python"
      },
      "outputs": [],
      "source": [
        "import yaml",
        "",
        "# Ejemplo de configuración YAML",
        "yaml_config = \"\"\"",
        "---",
        "hosts:",
        "  web:",
        "    - web1.example.com",
        "    - web2.example.com",
        "  db:",
        "    - db1.example.com",
        "",
        "vars:",
        "  ansible_user: admin",
        "  ansible_ssh_private_key_file: ~/.ssh/id_rsa",
        "\"\"\"",
        "",
        "# Parsear el YAML",
        "config = yaml.safe_load(yaml_config)",
        "print(\"Hosts web:\", config[\"hosts\"][\"web\"])",
        "print(\"Usuario Ansible:\", config[\"vars\"][\"ansible_user\"])"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "c3dff3cd",
        "language": "markdown"
      },
      "source": [
        "## Manipulación de JSON para APIs de Docker",
        "",
        "Trabajar con APIs REST en DevOps, como la de Docker:"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "adaee38c",
        "language": "python"
      },
      "outputs": [],
      "source": [
        "import json",
        "",
        "# Simular una respuesta de API de Docker",
        "docker_api_response = {",
        "  \"containers\": [",
        "    {\"id\": \"abc123\", \"image\": \"nginx:latest\", \"status\": \"running\"},",
        "    {\"id\": \"def456\", \"image\": \"postgres:13\", \"status\": \"stopped\"}",
        "  ]",
        "}",
        "",
        "# Convertir a JSON string",
        "json_str = json.dumps(docker_api_response, indent=2)",
        "print(\"Respuesta JSON:\")",
        "print(json_str)",
        "",
        "# Parsear de vuelta",
        "parsed = json.loads(json_str)",
        "running_containers = [c for c in parsed[\"containers\"] if c[\"status\"] == \"running\"]",
        "print(f\"\\nContenedores corriendo: {len(running_containers)}\")"
      ]
    },
    {
      "cell_type": "markdown",
      "metadata": {
        "id": "b4405874",
        "language": "markdown"
      },
      "source": [
        "## Ejecución de comandos del sistema con subprocess",
        "",
        "Para automatizar tareas como ejecutar comandos Docker o Ansible desde Python:"
      ]
    },
    {
      "cell_type": "code",
      "execution_count": null,
      "metadata": {
        "id": "4d27ef70",
        "language": "python"
      },
      "outputs": [],
      "source": [
        "import subprocess",
        "",
        "# Ejecutar un comando Docker",
        "def run_docker_command(command):",
        "    try:",
        "        result = subprocess.run(",
        "            [\"docker\"] + command.split(),",
        "            capture_output=True,
        "            text=True,
        "            check=True",
        "        )",
        "        return result.stdout.strip()",
        "    except subprocess.CalledProcessError as e:",
        "        return f\"Error: {e.stderr.strip()}\"",
        "",
        "# Ejemplo: Listar imágenes Docker",
        "# Nota: Esto fallará si Docker no está corriendo, pero muestra la estructura",
        "print(\"Ejecutando 'docker images'...\")",
        "output = run_docker_command(\"images --format 'table {{.Repository}}\t{{.Tag}}\t{{.Size}}'\")",
        "print(output)",
        "",
        "# Otro ejemplo: Verificar estado de servicios",
        "def check_service_status(service):",
        "    try:",
        "        result = subprocess.run(",
        "            [\"systemctl\", \"is-active\", service],",
        "            capture_output=True,
        "            text=True",
        "        )",
        "        return result.stdout.strip()",
        "    except FileNotFoundError:",
        "        return \"systemctl no disponible\"",
        "",
        "print(f\"\\nEstado de docker: {check_service_status('docker')}\")"
      ]
    }
  ],
  "metadata": {
    "kernelspec": {
      "display_name": "Python 3",
      "language": "python",
      "name": "python3"
    },
    "language_info": {
      "name": "python",
      "version": "3.11"
    }
  },
  "nbformat": 4,
  "nbformat_minor": 5
}
